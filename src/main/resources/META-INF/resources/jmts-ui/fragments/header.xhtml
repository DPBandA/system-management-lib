<!--
System Management (SM) 
Copyright (C) 2025  D P Bennett & Associates Limited

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.

Email: info@dpbennett.com.jm
-->
<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"   
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:form id="headerForm">

        <p:growl id="growl3" life="5000" showDetail="true" />

        <header>
            <!-- EXACT header markup you already have -->
            <!-- logo, notifications, user menu -->
            <div class="col-12 col-nogutter">
                <div class="grid">
                    <div class="col-12 md:col-3">
                        <h:panelGroup style="float: left;margin-right: 10px;" >
                            <p:graphicImage value="#{systemManager.logoURL}"
                                            class="logo"
                                            height="#{systemManager.logoURLImageHeight}" 
                                            width="#{systemManager.logoURLImageWidth}"/>
                        </h:panelGroup>
                        <h:panelGrid columns="1" cellspacing="0" >   

                            <p:outputLabel value="System Manager"
                                           class="header-text" />

                            <p:outputLabel value="System Administration &amp; Management"
                                           class="subheader-text" />  

                        </h:panelGrid>
                    </div>    
                    <div class="col-12 md:col-6"></div>  
                    <div class="col-12 md:col-3">
                        <h:panelGroup style="float: right;" >

                            <p:badge value="#{systemManager.sizeOfActiveNotifications}" 
                                     id="notificationBadge"
                                     rendered="false"
                                     visible="#{systemManager.hasActiveNotifications}" 
                                     severity="danger">

                                <p:commandButton id="notifications" 
                                                 class="notification-button"
                                                 icon="pi pi-bell" />
                                <p:overlayPanel for="notifications"   
                                                widgetVar="NotificationPanelVar"
                                                style="width:400px;border: 0;">
                                    <p:orderList value="#{systemManager.notifications}" 
                                                 var="notification" 
                                                 itemValue="#{notification}"
                                                 converter="#{notificationConverter}" 
                                                 controlsLocation="none" responsive="true" >

                                        <p:ajax event="select" 
                                                update=":headerForm:notificationBadge"
                                                oncomplete="PF('NotificationPanelVar').hide()"
                                                listener="#{systemManager.onNotificationSelect}" />

                                        <p:column>
                                            <p:outputLabel value="#{notification.name}" 
                                                           style="#{notification.style}"/>
                                        </p:column>                                           

                                    </p:orderList>
                                </p:overlayPanel>

                            </p:badge>
                            <p:spacer width="30"/>
                            <p:menuButton iconPos="left"
                                          icon="pi pi-user"
                                          title="#{systemManager.user.employee.firstName} #{systemManager.user.employee.lastName} (#{systemManager.user.username})"
                                          id="userMenu"
                                          class="usermenu-button" >

                                <p:menuitem actionListener="#{systemManager.viewUserProfile}"                                            
                                            update=":userProfileDialogForm"
                                            oncomplete="PF('userProfileDialog').show();"
                                            icon="pi pi-cog"
                                            value="Profile"
                                            process="@this"/>  
                                <p:menuitem actionListener="#{systemManager.logout}"                                             
                                            icon="pi pi-sign-out"
                                            value="Logout"
                                            oncomplete="location.reload();"
                                            process="@this"/>    

                            </p:menuButton>   
                        </h:panelGroup>
                    </div>
                </div>
            </div> 
        </header>

    </h:form>

</ui:composition>